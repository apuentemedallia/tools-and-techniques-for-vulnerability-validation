# 38626 - OpenSSL oracle padding vulnerability (CVE-2016-2107)

<!-- MarkdownTOC -->

- [Description](#description)
- [Solution](#solution)
- [Validation](#validation)
	- [Tools](#tools)
	- [Analysis](#analysis)
		- [Red Hat Package Manager](#red-hat-package-manager)
		- [Filippo.io GoLang Application](#filippoio-golang-application)

<!-- /MarkdownTOC -->


<a name="description"></a>
## Description
The OpenSSL Project is an Open Source toolkit implementing the Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS) protocols as well as a general purpose cryptography library. 
OpenSSL contains the following vulnerability:
A MITM attacker can use a padding oracle attack to decrypt traffic when the connection uses an AES CBC cipher and the server support AES-NI.
Affected Versions: 
OpenSSL 1.0.2 prior to OpenSSL 1.0.2h
OpenSSL 1.0.1 prior to OpenSSL 1.0.1t

**Impact:**
A MITM attacker can use a padding oracle attack to decrypt traffic.

<a name="solution"></a>
## Solution

OpenSSL version 1.0.2h and 1.0.1t have been released to address these issues. Refer to OpenSSL Advisory (https://www.openssl.org/news/secadv/20160503.txt) to obtain more information.
Patch: 
Following are links for downloading patches to fix the vulnerabilities:
OpenSSL Security Advisory 3rd May 2016 (https://www.openssl.org/news/secadv/20160503.txt)

**Workaround:**
- Recompile OpenSSL with the handshake removed from the code by compile time option -DOPENSSL_NO_HEARTBEATS.
<a name="validation"></a>
## Validation

<a name="tools"></a>
### Tools

* *[RPM Package Manager](https://http://rpm.org/):* The RPM Package Manager (RPM) is a powerful command line driven package management system capable of installing, uninstalling, verifying, querying, and updating computer software packages. Each software package consists of an archive of files along with information about the package like its version, a description, and the like. 
* *[Filippo.io](https://github.com/FiloSottile/CVE-2016-2107)* Simple test for the May 2016 OpenSSL padding oracle (CVE-2016-2107). **It only works with HTTPS**.
* *[CVE-2016-2107 web test](https://filippo.io/CVE-2016-2107/)* Simple web test for the May 2016 OpenSSL padding oracle (CVE-2016-2107). **It only works with HTTPS**.

<a name="analysis"></a>
### Analysis

<a name="red-hat-package-manager"></a>
#### Red Hat Package Manager

It is important to note that Qualys detects this vulnerability based on the banner of the application with SSL so in some cases a library might be backported remediating the issue but keeping the same banner causing Qualys to report a false positive. The following it the technique to validate that the correct patch has been installed and the vulnerability remediated.

**Command**

```
sudo rpm -q --changelog openssl | grep CVE-2016-2107
```

**Vulnerability Remediated Output**

If the command above returns the following output the vulnerability has been remediated:

```
* fix CVE-2016-2107 - padding oracle in stitched AES-NI CBC-MAC
```


<a name="filippoio-golang-application"></a>
#### Filippo.io GoLang Application 

**Command**

```
$ go version
go version go1.6.2 darwin/amd64
$ export GOPATH=${HOME}/go_work/
$ go get github.com/FiloSottile/CVE-2016-2107
$ ${GOPATH}/bin/CVE-2016-2107 engineering.medallia.com
2016/07/11 14:24:11 Vulnerable: false
```

**Vulnerability Remediated Output**

```
2016/07/11 14:24:11 Vulnerable: false
```



