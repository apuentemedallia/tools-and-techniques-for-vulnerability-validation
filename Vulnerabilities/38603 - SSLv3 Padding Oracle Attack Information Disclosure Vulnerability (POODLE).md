# 8603 - SSLv3 Padding Oracle Attack Information Disclosure Vulnerability (POODLE)

<!-- MarkdownTOC -->

- [Description](#description)
- [Solution](#solution)
- [Validation](#validation)
  - [Tools](#tools)
  - [Analysis](#analysis)
    - [Nmap](#nmap)

<!-- /MarkdownTOC -->


<a name="description"></a>
## Description
The SSL protocol 3.0 design error, uses nondeterministic CBC padding, which makes it easier for man-in-the-middle attacks.
The target supports SSLv3, which makes it vulnerable to POODLE (Padding Oracle On Downgraded Legacy Encryption), even if it also supports more recent versions of TLS. It's subject to a downgrade attack, in which the attacker tricks the browser into connecting with SSLv3.
<a name="solution"></a>
## Solution

Disable SSLv3 support to avoid this vulnerability. 
Examples to disable SSLv3. 
nginx: list specific allowed protocols in the "ssl\_protocols" line. Make sure SSLv2 and SSLv3 is not listed. For example: ssl_protocols TLSv2 TLSv1.1 TLSv1.2; 
Apache: Add -SSLv3 to the "SSLProtocol" line. 
How to disable SSL 3.0 on Microsoft IIS (https://support.microsoft.com/kb/187498/en-us).
For PCI, please refer to the Qualys community article (https://community.qualys.com/thread/15280).

<a name="validation"></a>
## Validation

<a name="tools"></a>
### Tools

* **[Nmap](https://nmap.org/download.html):** Nmap ("Network Mapper") is a free and open source (license) utility for network discovery and security auditing. Many systems and network administrators also find it useful for tasks such as network inventory, managing service upgrade schedules, and monitoring host or service uptime. Nmap uses raw IP packets in novel ways to determine what hosts are available on the network, what services (application name and version) those hosts are offering, what operating systems (and OS versions) they are running, what type of packet filters/firewalls are in use, and dozens of other characteristics. It was designed to rapidly scan large networks, but works fine against single hosts. Nmap runs on all major computer operating systems, and official binary packages are available for Linux, Windows, and Mac OS X. In addition to the classic command-line Nmap executable, the Nmap suite includes an advanced GUI and results viewer (Zenmap), a flexible data transfer, redirection, and debugging tool (Ncat), a utility for comparing scan results (Ndiff), and a packet generation and response analysis tool (Nping).

<a name="analysis"></a>
### Analysis

<a name="nmap"></a>
#### Nmap 

**Command**

```
nmap --version-light --script ssl-poodle -p <port> <server ip>
```

**Vulnerable Output**

```
ORT    STATE SERVICE REASON
<port>/tcp open  <protocol>   syn-ack
| ssl-poodle:
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  CVE:CVE-2014-3566  OSVDB:113251
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and
|           other products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the "POODLE" issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_3DES_EDE_CBC_SHA
|     References:
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       http://osvdb.org/113251
|       http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|_      https://www.openssl.org/~bodo/ssl-poodle.pdf

```


